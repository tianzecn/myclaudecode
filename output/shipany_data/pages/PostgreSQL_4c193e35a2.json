{
  "url": "https://shipany.ai/zh/docs/database/postgresql",
  "title": "PostgreSQL",
  "content": "PostgreSQL 是一个流行的开源关系型数据库管理系统。它广泛用于 Web 应用程序和后端系统。\n\nShipAny 支持 PostgreSQL 数据库。按照以下步骤快速开始。\n\n根据你的操作系统类型，自行搜索安装 PostgreSQL，通过命令行创建数据库：\n\n或者你也可以使用各类云服务器厂商提供的 PostgreSQL 云数据库服务。\n\n对上一步创建的数据库，你需要设置用户名、密码，分配权限，开启远程访问权限等。\n\n得到的数据库连接地址 DATABASE_URL 如下：\n\n在项目的环境变量文件中，填入 PostgreSQL 数据库相关的配置。\n\n使用 PostgreSQL 数据库时，数据表结构定义在 ./src/config/db/schema.postgres.ts 文件中，你需要导出这个文件的数据表。\n\n打开 ./src/config/db/schema.ts 文件，修改内容为：\n\n你可以在 PostgreSQL 数据库管理后台管理数据库，也可以在本地执行命令:\n\n如果你需要新增数据表，或者修改数据表字段，可以打开 ./src/config/db/schema.postgres.ts 文件，修改数据表结构。\n\n如果你需要修改数据表连接参数，比如配置自定义选项、连接池等，可以修改 ./src/core/db/postgres.ts 文件中的逻辑。\n\n在进行数据操作时，默认使用的是 ./src/core/db/index.ts 导出的 db() 对象，导出类型是 any，在某些情况下，可能会缺乏类型提示。\n\n如果你希望使用强类型的数据库对象，可以在操作数据时，使用以下方式获取数据库对象：\n\n使用 Cloudflare Workers 部署项目时，暂不支持使用 PostgreSQL 数据库。\n\n你可以使用 Supabase、Neon 等兼容 PostgreSQL 的数据库服务。\n\nPostgreSQL 使用 public 作为默认 Schema。在同一个 PostgreSQL 数据库中，可以创建多个 Schema，来存储多个不同项目的数据。\n\n通过命令登录到 PostgreSQL 数据库。\n\n比如这里创建一个名为 project_2 的 Schema，创建自定义 Schema 的命令如下：\n\n在新项目的环境变量文件中，填入 PostgreSQL 数据库相关的配置。\n\n可以通过命令登录到 PostgreSQL 数据库。\n\n打开数据库管理面板，切换到新项目的 Schema，管理数据表。\n\nDrizzle ORM 接入 PostgreSQL 文档",
  "headings": [
    {
      "level": "h1",
      "text": "PostgreSQL",
      "id": ""
    },
    {
      "level": "h2",
      "text": "快速开始",
      "id": "快速开始"
    },
    {
      "level": "h2",
      "text": "自定义",
      "id": "自定义"
    },
    {
      "level": "h3",
      "text": "修改数据表",
      "id": "修改数据表"
    },
    {
      "level": "h3",
      "text": "修改数据库连接",
      "id": "修改数据库连接"
    },
    {
      "level": "h3",
      "text": "部署到 Cloudflare Workers",
      "id": "部署到-cloudflare-workers"
    },
    {
      "level": "h3",
      "text": "通过 Schema 隔离数据",
      "id": "通过-schema-隔离数据"
    },
    {
      "level": "h2",
      "text": "参考",
      "id": "参考"
    }
  ],
  "code_samples": [
    {
      "code": "postgresql://user:password@host:port/database",
      "language": "yaml"
    },
    {
      "code": "psql \"postgresql://user:password@host:port/database\"",
      "language": "python"
    },
    {
      "code": "DATABASE_PROVIDER = \"postgresql\"\nDATABASE_URL = \"postgresql-database-url\"\nDB_SCHEMA_FILE = \"./src/config/db/schema.postgres.ts\"\nDB_MIGRATIONS_OUT = \"./src/config/db/migrations\"",
      "language": "unknown"
    },
    {
      "code": "export * from './schema.postgres';",
      "language": "sql"
    },
    {
      "code": "pnpm db:generate\npnpm db:migrate",
      "language": "unknown"
    },
    {
      "code": "pnpm db:studio",
      "language": "unknown"
    },
    {
      "code": "pnpm db:generate\npnpm db:migrate",
      "language": "unknown"
    },
    {
      "code": "import { db } from '@/core/db';\nimport { user } from '@/config/db/schema';\n\nconst [result] = await db().select().from(user).limit(1);",
      "language": "csharp"
    },
    {
      "code": "import { dbPostgres } from '@/core/db';\nimport { user } from '@/config/db/schema';\n\nconst [result] = await dbPostgres().select().from(user).limit(1);",
      "language": "csharp"
    },
    {
      "code": "import { getPostgresDb } from '@/core/db/postgres';\nimport { user } from '@/config/db/schema';\n\nconst [result] = await getPostgresDb().select().from(user).limit(1);",
      "language": "csharp"
    },
    {
      "code": "psql \"postgresql://user:password@host:port/database\"",
      "language": "python"
    },
    {
      "code": "CREATE SCHEMA project_2;",
      "language": "unknown"
    },
    {
      "code": "# postgresql\nDATABASE_PROVIDER = \"postgresql\"\nDATABASE_URL = \"postgresql://user:password@host:port/database\"\n\nDB_SCHEMA_FILE = \"./src/config/db/schema.postgres.ts\"\nDB_MIGRATIONS_OUT = \"./src/config/db/migrations_project_2\"\nDB_SCHEMA = \"project_2\"\nDB_MIGRATIONS_SCHEMA = \"project_2\"\nDB_MIGRATIONS_TABLE = \"__drizzle_migrations\"",
      "language": "markdown"
    },
    {
      "code": "pnpm db:generate\npnpm db:migrate",
      "language": "unknown"
    },
    {
      "code": "psql \"postgresql://user:password@host:port/database\"",
      "language": "python"
    },
    {
      "code": "SET search_path TO project_2;",
      "language": "unknown"
    },
    {
      "code": "pnpm db:studio",
      "language": "unknown"
    }
  ],
  "patterns": [],
  "links": [
    "https://shipany.ai/zh/docs/quick-start",
    "https://shipany.ai/zh/docs/config",
    "https://shipany.ai/zh/docs/page-builder",
    "https://shipany.ai/zh/docs/vibe-coding",
    "https://shipany.ai/zh/docs/database",
    "https://shipany.ai/zh/docs/database/supabase",
    "https://shipany.ai/zh/docs/database/neon",
    "https://shipany.ai/zh/docs/database/postgresql",
    "https://shipany.ai/zh/docs/database/turso",
    "https://shipany.ai/zh/docs/database/sqlite",
    "https://shipany.ai/zh/docs/database/mysql",
    "https://shipany.ai/zh/docs/email",
    "https://shipany.ai/zh/docs/analytics",
    "https://shipany.ai/zh/docs/ads",
    "https://shipany.ai/zh/docs/customer-service"
  ]
}