{
  "url": "https://shipany.ai/zh/docs/database/supabase",
  "title": "Supabase",
  "content": "Supabase 是一个以 PostgreSQL 为核心的云数据库开发平台，它围绕 PostgreSQL 构建，提供包括数据库、身份认证、实时订阅、文件存储和边缘函数等后端服务，并通过 RESTful 和 GraphQL API 将 PostgreSQL 的能力暴露给开发者，无需自己搭建后端服务。\n\n在 ShipAny 项目中，你可以使用 Supabase 来存储和管理你的数据。\n\n你可以按照以下步骤，在 ShipAny 项目中接入 Supabase。\n\n访问 Supabase 官网，注册一个 Supabase 账号。.\n\n进入 Supabase 控制台，创建一个项目。\n\n输入项目名称，点击 Generate a password，生成随机密码，点击 Copy 按钮，复制密码。\n\n进入上一步创建的项目管理页面，点击顶部的 Connect 按钮，切换到 ORMs -> Drizzle 标签页，复制 DATABASE_URL 的值。\n\n把 [YOUR-PASSWORD] 替换成上一步生成的随机密码，得到 Supabase 项目的 DATABASE_URL。类似这种：\n\n使用 psql 工具，测试数据库是否能正常连接。\n\n请自行搜索 psql 工具的安装方法。一般情况，在本地安装 PostgreSQL 后，会自带 psql 工具。\n\n复制上一步设置的数据库 DATABASE_URL。\n\n在项目的环境变量文件中，填入 Supabase 数据库相关的配置。\n\n使用 Supabase 数据库时，数据表结构定义在 ./src/config/db/schema.postgres.ts 文件中，你需要导出这个文件的数据表。\n\n打开 ./src/config/db/schema.ts 文件，修改内容为：\n\n你可以在 Supabase 控制台 管理数据库，也可以在本地执行命令:\n\n如果你需要新增数据表，或者修改数据表字段，可以打开 ./src/config/db/schema.postgres.ts 文件，修改数据表结构。\n\n如果你需要修改数据表连接参数，比如配置自定义选项、连接池等，可以修改 ./src/core/db/postgres.ts 文件中的逻辑。\n\n在进行数据操作时，默认使用的是 ./src/core/db/index.ts 导出的 db() 对象，导出类型是 any，在某些情况下，可能会缺乏类型提示。\n\n如果你希望使用强类型的数据库对象，可以在操作数据时，使用以下方式获取数据库对象：\n\nSupabase 数据库支持部署到 Cloudflare Workers，也支持使用 Hyperdrive 加速数据库访问。\n\n使用 Hyperdrive 加速数据库访问的配置参考：配置 Hyperdrive。\n\n在 Cloudflare Workers 部署项目使用 Supabase 数据库的 wrangler.toml 部分内容参考：\n\nSupabase 每新建一个项目，需要额外支付 10 美金/月的基础费用。如果你的项目比较多，可以考虑复用同一个 Supabase 项目，通过 Schema 隔离数据。\n\nSupabase 使用 public 作为默认 Schema。在同一个 Supabase 项目中，可以创建多个 Schema，来存储多个不同项目的数据。\n\n进入 Supabase 项目的 Table Editor 页面，点击 schema 下拉框，点击 Create a new schema，输入 Schema name 创建自定义 Schema。\n\n比如这里创建一个名为 project_2 的 Schema。\n\n在新项目的环境变量文件中，填入 Supabase 数据库相关的配置。\n\n你可以在 Supabase 控制台 ，切换到新项目的 Schema，管理数据表。\n\n打开数据库管理面板，切换到新项目的 Schema，管理数据表。",
  "headings": [
    {
      "level": "h1",
      "text": "Supabase",
      "id": ""
    },
    {
      "level": "h2",
      "text": "快速开始",
      "id": "快速开始"
    },
    {
      "level": "h2",
      "text": "自定义",
      "id": "自定义"
    },
    {
      "level": "h3",
      "text": "修改数据表",
      "id": "修改数据表"
    },
    {
      "level": "h3",
      "text": "修改数据库连接",
      "id": "修改数据库连接"
    },
    {
      "level": "h3",
      "text": "部署到 Cloudflare Workers",
      "id": "部署到-cloudflare-workers"
    },
    {
      "level": "h3",
      "text": "通过 Schema 隔离数据",
      "id": "通过-schema-隔离数据"
    },
    {
      "level": "h2",
      "text": "参考",
      "id": "参考"
    }
  ],
  "code_samples": [
    {
      "code": "postgresql://postgres.seilzcqsafesmugglqlk:xxxxxx@aws-1-ap-northeast-1.pooler.supabase.com:6543/postgres",
      "language": "yaml"
    },
    {
      "code": "psql \"postgresql://postgres.seilzcqsafesmugglqlk:xxxxxx@aws-1-ap-northeast-1.pooler.supabase.com:6543/postgres\"",
      "language": "python"
    },
    {
      "code": "DATABASE_PROVIDER = \"postgresql\"\nDATABASE_URL = \"supabase-database-url\"\nDB_SCHEMA_FILE = \"./src/config/db/schema.postgres.ts\"\nDB_MIGRATIONS_OUT = \"./src/config/db/migrations\"",
      "language": "unknown"
    },
    {
      "code": "export * from './schema.postgres';",
      "language": "sql"
    },
    {
      "code": "pnpm db:generate\npnpm db:migrate",
      "language": "unknown"
    },
    {
      "code": "pnpm db:studio",
      "language": "unknown"
    },
    {
      "code": "pnpm db:generate\npnpm db:migrate",
      "language": "unknown"
    },
    {
      "code": "import { db } from '@/core/db';\nimport { user } from '@/config/db/schema';\n\nconst [result] = await db().select().from(user).limit(1);",
      "language": "csharp"
    },
    {
      "code": "import { dbPostgres } from '@/core/db';\nimport { user } from '@/config/db/schema';\n\nconst [result] = await dbPostgres().select().from(user).limit(1);",
      "language": "csharp"
    },
    {
      "code": "import { getPostgresDb } from '@/core/db/postgres';\nimport { user } from '@/config/db/schema';\n\nconst [result] = await getPostgresDb().select().from(user).limit(1);",
      "language": "csharp"
    },
    {
      "code": "[[hyperdrive]]\nbinding = \"HYPERDRIVE\"\nid = \"your-hyperdrive-config-id\"\nlocalConnectionString = \"postgresql://xxx:xxxxxx@xxx.supabase.com:6543/postgres\"\n\n[vars]\nDATABASE_PROVIDER = \"postgresql\"\nDATABASE_URL = \"postgresql://xxx:xxxxxx@xxx.supabase.com:6543/postgres\"",
      "language": "json"
    },
    {
      "code": "# supabase\nDATABASE_PROVIDER = \"postgresql\"\nDATABASE_URL = \"postgresql://xxx:xxx.pooler.supabase.com:6543/postgres\"\n\nDB_SCHEMA_FILE = \"./src/config/db/schema.postgres.ts\"\nDB_MIGRATIONS_OUT = \"./src/config/db/migrations_project_2\"\nDB_SCHEMA = \"project_2\"\nDB_MIGRATIONS_SCHEMA = \"project_2\"\nDB_MIGRATIONS_TABLE = \"__drizzle_migrations\"",
      "language": "markdown"
    },
    {
      "code": "pnpm db:generate\npnpm db:migrate",
      "language": "unknown"
    },
    {
      "code": "pnpm db:studio",
      "language": "unknown"
    }
  ],
  "patterns": [],
  "links": [
    "https://shipany.ai/zh/docs/quick-start",
    "https://shipany.ai/zh/docs/config",
    "https://shipany.ai/zh/docs/page-builder",
    "https://shipany.ai/zh/docs/vibe-coding",
    "https://shipany.ai/zh/docs/database",
    "https://shipany.ai/zh/docs/database/supabase",
    "https://shipany.ai/zh/docs/database/neon",
    "https://shipany.ai/zh/docs/database/postgresql",
    "https://shipany.ai/zh/docs/database/turso",
    "https://shipany.ai/zh/docs/database/sqlite",
    "https://shipany.ai/zh/docs/database/mysql",
    "https://shipany.ai/zh/docs/email",
    "https://shipany.ai/zh/docs/analytics",
    "https://shipany.ai/zh/docs/ads",
    "https://shipany.ai/zh/docs/customer-service",
    "https://shipany.ai/zh/docs/deploy/cloudflare"
  ]
}